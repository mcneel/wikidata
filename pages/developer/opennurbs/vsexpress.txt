======Using OpenNURBS 4.0 with Visual C++ 2005 Express Edition======

> **Developer:** //[[developer:opennurbs:home|OpenNURBS]]//
> **Summary:** //Discusses using the openNURBS toolkit with Visual C++ 2005 Express Edition//

You can use Visual C++ Express to build .NET Framework applications immediately after installation. But, in order to use Visual C++ Express to build the [[developer:opennurbs:home|openNURBS]] toolkit, you'll need to take just a few more steps.

=====Step 1: Install Visual C++ Express Edition=====
If you haven't done so already, install [[http://msdn.microsoft.com/vstudio/express/visualc/download/|Visual C++ Express Edition]].

=====Step 2: Install the Microsoft Platform SDK.=====
Install the [[http://www.microsoft.com/downloads/details.aspx?familyid=0BAF2B35-C656-4969-ACE8-E4C0C0716ADB|Platform SDK.]] Follow the instructions and install the SDK for the x86 platform.

=====Step 3: Update the Visual C++ directories=====
Launch Visual C++ Express. In the Projects and Solutions section Options dialog box, add the paths to the appropriate subsection:

  * Executable files: C:\Program Files\Microsoft Platform SDK for Windows Server 2003\Bin
  * Include files: C:\Program Files\Microsoft Platform SDK for Windows Server 2003\Include
  * Include files: C:\Program Files\Microsoft Platform SDK for Windows Server 2003\MFC
  * Library files: C:\Program Files\Microsoft Platform SDK for Windows Server 2003\Lib

=====Step 4: Update the corewin_express.vsprops file.=====
One more step is needed to make the Win32 template work in Visual C++ Express. You need to edit the corewin_express.vsprops file (found in C:\Program Files\Microsoft Visual Studio 8\VC\VCProjectDefaults) and change the string that reads:

   AdditionalDependencies="kernel32.lib"

to

   AdditionalDependencies="kernel32.lib user32.lib gdi32.lib winspool.lib comdlg32.lib advapi32.lib shell32.lib ole32.lib oleaut32.lib uuid.lib"

=====Step 5: Generate and build a Win32 Test Application=====

In Visual C++ Express, the Win32 Windows Application type is disabled in the Win32 Application Wizard. To enable that type, you need to edit the file AppSettings.htm file located in the folder "..\Program Files\Microsoft Visual Studio 8 VC\VCWizards\AppWiz\Generic\Application\html\1033\".

In a text editor comment out lines 441 - 444 as shown here:

<code c++>
// WIN_APP.disabled = true;
// WIN_APP_LABEL.disabled = true;
// DLL_APP.disabled = true;
// DLL_APP_LABEL.disabled = true;
</code>

Save and close the file and open Visual C++ Express.

From the File menu, click New Project. In the New Project dialog box, expand the Visual C++ node in the Product Types tree and then click Win32. Click on the Win32 Console Application template and then give your project a name and click OK. In the Win32 Application Wizard dialog box, make sure that Windows application is selected as the Application type and the ATL is not selected. Click the Finish button to generate the project.

As a final step, test your project by clicking the Start button in the IDE or by pressing F5. Your Win32 application should build and run.

=====Step 6: Download and Unzip openNURBS=====

If you haven't done so already, download and unzip [[http://www.opennurbs.org|openNURBS.]]

=====Step 7. Build openNURBS=====

Open the opennurbs.sln solution file. You will need to add to the Linker->Additional Dependencies section of the opennurbs and the opennurbs_static projects to include the following additional libraries:

   advapi32.lib gdi32.lib shell32.lib user32.lib

Do not forget to modify both Debug and Release configurations.

The [[developer:opennurbs:home|openNURBS]] toolkit should now build in Visual C++ Express.

\\

{{tag>Developer openNURBS}}
