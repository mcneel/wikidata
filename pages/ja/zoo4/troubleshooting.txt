====== Zooのトラブルシューティング ======
> **製品:** //[[ja:zoo4:home|Zoo 4.0]]//
> **要約:** //Zooワークグループライセンスマネージャに関する問題解決のヒント//

Zooは**メールスロット**という、シンプルでプロトコルに依存しないメッセージングテクノロジを使用してRhinoと通信します。Microsoftネットワークはドメインのログオンサービスを含む様々なエリアでメールスロットメッセージを使用しています。メールスロットメッセージングは最近のMicrosoftオペレーティングシステム全てで動作します。メールスロットメッセージングはワークグループネットワークとドメインネットワークの両方で動作します。

Zooの設定については、全く何もする必要がありません。すべてのコンピュータが同じWindowsドメインまたはワークグループに属し、同じサブネットにインストールされていればZooは要求に応じてライセンスを割り当てられるはずですが、Zooをご使用の際は以下の点にご留意ください:

  * 最新バージョンのZooが実行されていることを確認してください。
  * Zooコンソールアプリケーションを実行する際は管理者ユーザーまたは管理者ユーザーグループのメンバーとしてログインしていることを確認してください。
  * Rhinoや、Brazil、Bongo、Flamingo、[[penguin:home|Penguin]]といったZooをサポートするプラグインは、最新のサービスリリースが実行されていることを確認してください。

===== アプリケーションに関する留意点 =====
  * ZooはWindows 2000、Windows XP、Windows Vista、Windows 7、Windows Server 2000、2003、2008のシステムで動作します。
  * Zooは[[http://www.microsoft.com/ja-JP/download/details.aspx?id=5638|Microsoft C++ 2005 SP1 再頒布可能パッケージ (x86)]]がシステムにインストールされていることが必要です。
  * ZooはRhino 2.0または3.0の教育版または教育版ラボラトリーライセンス(CD-Key)とは使用できません。
  * Zooはアジア言語版のWindowsで実行されているRhino 2.0または3.0とは使用できません。
  * すべての製品がルーターを介したネットワークを越えてライセンスを取得できるわけではありません。ルーターを使用したネットワークでZooが実行できる製品、できない製品の一覧については[[ja:zoo:products|Zooと製品の互換性]]ページをご覧ください。
  * Zooコンソールアプリケーションを実行する際は管理者ユーザーまたは管理者ユーザーグループのメンバーとしてログインしてください。

===== ネットワークに関する留意点 =====
  * すべてのシステムは同じ**Windowsドメインまたはワークグループ**に属している必要があります。
  * 使用しているネットワーク接続に**Microsoftネットワーク用クライアント**がインストールされ、有効になっていることを確認してください。そうでない場合、//Failed to write to client mailslot//（クライアントのメールスロットへの書き込みに失敗しました）というエラーがZooのログファイルに書き込まれます。
  * TCP/IPを使用している場合は、TCP/IPの詳細設定オプションで**[[ ja:rhino:netbios|NetBIOS]] over TCP/IPを有効にする**が設定されていることを確認してください。そうでない場合、//Failed to write to client mailslot//（クライアントのメールスロットへの書き込みに失敗しました）というエラーがZooのログファイルに書き込まれます。
  * RhinoまたはZooのいずれかを実行しているコンピュータがファイアウォールを使用している場合、次のポートが開かれていることを確認してください。
    * **UDPポート137および138**
    * **TCPポート139**
  * これらのポートはWindowsが[[ja:rhino:netbios|NetBIOS]]通信に使用します。組み込みの**Windowsファイアウォール**を使用している場合は、例外で**ファイルとプリンタの共有**を有効にしておいてください。
\\
{{:ja:zoo:zoo_windows_firewall_j.png|}}
  *RhinoのシステムをDNSまたはレジストリキーの参照ができるように設定していない場合は、すべてのRhinoのワークステーションとZooを実行しているシステムを同じネットワークサブネットにインストールする必要があります。これはRhinoとZooの両方がメッセージをブロードキャストするからです。ブロードキャストされるメールスロットメッセージは、ネットワークルーターや一部のスイッチを通りません。ワイヤレスルーターもブロードキャストメッセージを転送しません。



==== Zooとクライアントの間の名前解決の動作の確認 ====
**nbtstat**は、[[ja:rhino:netbios|NetBIOS]]の名前解決の問題のトラブルシューティングに役立つようデザインされています。ネットワークが問題なく機能している場合、[[ja:rhino:netbios|NetBIOS]] over TCP/IPは [[ja:rhino:netbios|NetBIOS]]名に対するIPアドレスを解決します。これはローカルキャッシュ参照、WINSサーバー問い合わせ、ブロードキャスト、LMHOSTSおよびHOSTS参照、DNS サーバー問い合わせを含む、[[ja:rhino:netbios|NetBIOS]]名前解決のためのいくつかのオプションを通して行われます。

**nbtstat**を使用して名前解決をテストするには:

  - Zooサーバーでコマンドプロンプトを開きます。
  - **nbtstat -a <クライアントコンピュータ名>**とタイプします。
  - ネットワークアダプタの1つがクライアントコンピューターの名前解決をします。
  - クライアントコンピューターでコマンドプロンプトを開きます。
  - **nbtstat -a <Zooサーバー名>**とタイプします。
  - ネットワークアダプタの1つがZooコンピュータの名前解決をします。

**nbtstat**がZoo、クライアントいずれの情報も返さない場合、Zooはこのネットワークの設定では動きません。この場合はこのドキュメントやMcNeelサポートの範囲ではなく、お使いのネットワークが適切な[[ja:rhino:netbios|NetBIOS]]名前解決をサポートするようにするお手伝いはできません。

==== Zooとクライアント間の接続の確認 ====
**net view**コマンドは、ドメイン、コンピューター、または特定のコンピューター上で利用可能な共有リソースの一覧を表示します。パラメータを付けずに使用すると、**net view**は現在のドメイン内のコンピューターの一覧を表示します。

**net view**コマンドを使用して接続をテストするには:

  - Zooサーバーでコマンドプロンプトを開きます。
  - **net view \\<クライアントコンピューター名>**とタイプします。
  - クライアントコンピューターでコマンドプロンプトを開きます。
  - **net view \\<Zooサーバー名>**とタイプします。

**net view**コマンドは一時的な接続を確立することで、ファイル共有と印刷共有の一覧を表示します。

  * 指定したコンピューターにファイル共有も印刷共有もない場合は、**net view**コマンドは //一覧にエントリが存在しません// というメッセージを表示します。
  * [システムエラー53が発生しました]というメッセージが表示されて**net view**コマンドが失敗した場合は、コンピューター名が正しいこと、コンピューターが動作可能であること、およびこのコンピューターと使用するコンピューターの間にある全てのゲートウェイ (ルーター) が動作可能であることを確認します。
  * [システムエラー5が発生しました。アクセスが拒否されました。]というメッセージが表示されて**net view**コマンドが失敗した場合は、リモートコンピューター上の共有を表示するアクセス許可を持つアカウントを使用してログオンしていることを確認します。

この接続の問題をさらにトラブルシューティングするには、次の操作を行います。

  * **net view**コマンドとコンピューターのIPアドレスを、このように指定します: **net view \\<IPアドレス>**
  * **net view**コマンドが成功した場合、コンピューター名は間違ったIPアドレスに解決されています。
  * **net view**コマンドが成功した場合、コンピューター名は間違ったIPアドレスに解決されています。

===== Zooに関する留意点 =====
  * ZooはRhinoクライアントとの交信ログファイル(**ZOO.LOG**)を保存することができます。ログファイルはいくつかの通信の問題を診断するのに役立つことがあります。ZOO.EXEがあるフォルダにログファイルが見つからない場合、ZooアプリケーションでTools→Optionsを選択するとログ記録をオンにすることができます。NOTEPAD.EXEを使ってログファイルをチェックすると、RhinoのメッセージをZooが受け取り、Zooがそのメッセージに応答しているかどうかを確認することができます。

===== Zoo ボーナスツール =====
ルーターのあるネットワークでZooを使用する際にRhinoがZooを見つけられない場合は、Zoo参照（レジストリキーまたはDNS）が正しく設定されていないことが考えられます。この場合、Zooボーナスツールを使うと問題が解決することがあります。Zooボーナスツールには以下のユーティリティが含まれています。

  - **SetZooServer.exe** - ワークステーションのレジストリキー参照設定を手助けします。
  - **ZooDnsResolver.exe** - DNS参照機能のテストを手助けします。

**{{:zoo:zoobonustools_20010621.zip|Zooボーナスツール}}**
