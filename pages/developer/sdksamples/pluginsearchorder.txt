====== Plug-in Search Order ======
====== C++ ======
> **Version:** //Rhino 4.0//

Also see [[developer:sdksamples:loadlibraryex|Plug-in Loading.]]

=====Overview=====
Rhino plug-ins are Windows Dynamic Link Libraries (DLLs). As such, Rhino uses Windows to load your plug-in. Rhino attempts to load your plug-in, and any dependent DLLs, in the following manner:

  - Alternate Search Order - uses **LoadLibraryEx** with the LOAD_WITH_ALTERED_SEARCH_PATH flag.
  - Standard Search Order - uses **LoadLibrary**.

**Note:** Starting with Windows XP, the dynamic-link library (DLL) search order used by the system depends on the setting of the **HKLM\System\CurrentControlSet\Control\Session Manager\SafeDllSearchMode** value.

  * Windows Server 2003:  The default value is 1.
  * Windows XP:  The default value is 0.

=====Alternate search order=====

The **LoadLibraryEx** function supports an alternate search order if the call specifies LOAD_WITH_ALTERED_SEARCH_PATH and the lpFileName parameter specifies a path. If **SafeDllSearchMode** is 1, the alternate search order is:

  - The directory specified by lpFileName.
  - The system directory. Use the **GetSystemDirectory** function to get the path of this directory.
  - The 16-bit system directory. There is no function that obtains the path of this directory, but it is searched.
  - The Windows directory. Use the **GetWindowsDirectory** function to get the path of this directory.
  - The current directory.
  - The directories listed in the PATH environment variable.

If **SafeDllSearchMode** is 0, the alternate search order is:

  - The directory specified by lpFileName.
  - The current directory.
  - The system directory. Use the **GetSystemDirectory** function to get the path of this directory.
  - The 16-bit system directory. There is no function that obtains the path of this directory, but it is searched.
  - The Windows directory. Use the **GetWindowsDirectory** function to get the path of this directory.
  - The directories listed in the PATH environment variable.

=====Standard search order=====
If **SafeDllSearchMode** is 1, the search order is:

  - The directory from which the application loaded.
  - The system directory. Use the **GetSystemDirectory** function to get the path of this directory.
  - The 16-bit system directory. There is no function that obtains the path of this directory, but it is searched.
  - The Windows directory. Use the **GetWindowsDirectory** function to get the path of this directory.
  - The current directory.
  - The directories listed in the PATH environment variable.

If **SafeDllSearchMode** is 0, the search order is:

  - The directory from which the application loaded.
  - The current directory.
  - The system directory. Use the **GetSystemDirectory** function to get the path of this directory.
  - The 16-bit system directory. There is no function that obtains the path of this directory, but it is searched.
  - The Windows directory. Use the **GetWindowsDirectory** function to get the path of this directory.
  - The directories listed in the PATH environment variable.

Windows 2000 does not support the **SafeDllSearchMode** value. The search order for Windows 2000 is:

  - The directory from which the application loaded.
  - The current directory.
  - The system directory. Use the **GetSystemDirectory** function to get the path of this directory.
  - The 16-bit system directory. There is no function that obtains the path of this directory, but it is searched.
  - The Windows directory. Use the **GetWindowsDirectory** function to get the path of this directory.
  - The directories listed in the PATH environment variable.



{{tag>Developer cplusplus}}
