====== Digitally Signing Plug-ins ======
> **Developer:** //[[developer:zoo|Zoo 5.0]]//
> **Summary:** //Discusses how to digitally sign Zoo 5.0 and Rhino 5.0 plug-ins.//

===== Overview =====
To add plug-ins to Zoo 5.0, and to call the license functions from within your Rhino 5.0 plug-in, you must digitally sign your plug-ins using a certificate that is signed by the Robert McNeel & Associates Code Signing Authority.

===== Generate a Private Key and Certificate Signing Request =====
  * Download and install **[[http://www.openssl.org/related/binaries.html|OpenSSL]]**.
  * Save the contents of **{{:developer:digital-signatures:mcneelcodesigning.zip|McNeelCodeSigning.zip}}** into a folder where you have write permissions - generally your plug-in project folder-.
  * Start a Windows Command Prompt.
  * Add the OpenSSL installation folder to your Windows path.
<code>
set path=C:\OpenSSL-Win32\bin;%path%
</code>
  * From the command prompt, run **CreateRequest.bat <filename>**, where filename is the name (without an extension) that will be used to save your private key (.KEY), certificate signing request (.CSR), and final signed digital certificate (.CRT).
  * You will be prompted to answer some questions; be sure to answer them correctly.
<code>
C:\Dev\Zoo> CreateRequest.bat TestZooPluginKey
Loading 'screen' into random state - done
Generating RSA private key, 4096 bit long modulus
................................................................................
e is 65537 (0x10001)
Loading 'screen' into random state - done
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
-----
Country Name (2 letter code) []: <COUNTRY NAME>
State or Province Name (full name) []: <STATE OR PROVINCE>
Locality Name (eg, city) []: <CITY>
Organization Name (eg, company) []: <ORGANIZATON>
Organizational Unit Name (eg, section) []: <ORGANIZATIONAL UNIT>
Common Name (eg, your websites domain name) []: <DOMAIN NAME>

Please enter the following 'extra' attributes
to be sent with your certificate request
A challenge password []: <PASSWORD>

Saved private key: 'TestZooPluginKey.key'
Saved CSR: 'TestZooPluginKey.csr'
</code>

===== Requesting a Signed Digital Certificate =====
  - E-mail the certificate signing request (.CSR) created above to [[brian@mcneel.com|Brian Gillespie]], along with a request for a certificate.
  - We will process your request and, if it is approved, will send you a signed digital certificate (.CRT).

===== Creating a Personal Information Exchange =====
In order to digitally sign your Zoo 5.0 or Rhino 5.0 plug-in, you will need to convert the signed digital certificate (.CRT), emailed to your upon approval, into a personal information exchange (.PFX) file.
  * Copy the signed digital certificate (.CRT) you receive into the same folder as your private key (.KEY) and certificate signing request (.CSR).
  * Start a Windows Command Prompt.
  * Add the OpenSSL installation folder to your Windows path.
<code>
set path=C:\OpenSSL-Win32\bin;%path%
</code>
  * From the command prompt, run **MakePfxFile.bat <filename>**, where filename is the name (without an extension).
<code>
C:\Dev\Zoo\TestZooPlugin>MakePfxFile.bat TestZooPluginKey
Loading 'screen' into random state - done
Enter Export Password: <PRESS ENTER>
Verifying - Enter Export Password: <PRESS ENTER>
Created 'TestZooPluginKey.pfx'. Use this to sign your executable code.
</code>

===== Sign your Plug-ins =====
  * Now that you have a personal information exchange (.PFX), you can use it to sign Zoo 5.0 and Rhino 5.0 plug-ins.
  * Open a Visual Studio Command Prompt.
  * Use **Signtool.exe**, with the following syntax, to digitally sign your plug-ins.
<code>
signtool.exe sign /f <filename>.pfx /t http://timestamp.verisign.com/scripts/timstamp.dll /v <plugin>
</code>
  * For example:
<code>
C:\Dev\Zoo\TestZooPlugin> signtool sign /f TestZooPluginKey.pfx /t http://timestamp.verisign.com/scripts/timstamp.dll /v TestZooPlugin.dll
The following certificate was selected:
    Issued to: MCNEEL.COM
    Issued by: McNeel Software Development
    Expires:   <DATE>
    SHA1 hash: <HASH>

Done Adding Additional Store
Successfully signed and timestamped: TestZooPlugin.dll

Number of files successfully Signed: 1
Number of warnings: 0
Number of errors: 0
</code>


\\

{{tag>Developer zoodev}}
