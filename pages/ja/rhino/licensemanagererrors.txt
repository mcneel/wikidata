====== "ライセンスマネージャと通信できない" エラーの解決 ======
> **Summary:** //“ライセンスマネージャと通信できない”エラーを解決するヒント//

> **Updated:** //2010年3月25日//（McNeelアジア、Kelvin Cheng）
経験的には、次の方法で解決できるようです。

  - Rhinoをアンインストールします。
  - C:\Program Files\Common Files\McNeel Shared\（32ビット）または C:\Program Files (x86)\Common Files\McNeel Shared\（64ビット）にあるLicense Manager フォルダを削除します。
  - 再度Rhino 4をインストールし、アップグレードします。

> **Updated:** //2010年1月12日// （McNeelシアトル、John Brock）
Rhino V4をVistaまたはWindows 7で実行している場合に同じエラーが起こる場合、ユーザーアカウント制御が競合している可能性があります。Rhino V4アイコンを右クリックし、 「管理者として実行」を選択します。これで問題が解決する場合はRhino V4 サービスリリース7をダウンロード、インストールしてください。SR7のインストールで問題は修正されるはずです。

> **Updated:** //2008年5月21日//

=====問題=====
Rhino 3.0またはRhino 4.0のいずれかを実行いずれかを実行した際、次のようなエラーメッセージが表示されます

{{http://jp.wiki.mcneel.com/content/upload/images/rhinolicensemanager.PNG}}
\\

=====原因=====
“ライセンスマネージャと通信できません。”というメッセージは、Rhinoが次に挙げるライセンスマネージャモジュールと通信できないために起こります。これはスタンドアロンノード、ワークグループノードのどちらでも起こる可能性があります。

このエラーは次の1つによるものです。

  - ライセンスマネージャファイルが欠けている
  - Windowsのシステムレジストリエントリが欠けている
  - ランタイムライブラリのサポートファイルが欠けている
  - 誤ったライセンスマネージャが実行中になっている
  - Windowsレジストリのセキュリティの問題
\\

=====解決策1 - 最新のサービスリリースを入手する=====

最新のサービスリリースは [[http://download.rhino3d.com/rhino/sr.asp|こちらのページ]] からダウンロードして頂けます。

Rhino V4をVistaまたはWindows 7で実行中に同じエラーが起こる場合、ユーザーアカウント制御が競合している可能性があります。Rhino V4アイコンを右クリックし、 「管理者として実行」を選択します。これで問題が解決する場合はRhino V4 サービスリリース7をダウンロード、インストールしてください。SR7のインストールで問題は修正されるはずです。

=====解決策2 - ライセンスマネージャファイルが欠けている=====
ライセンスマネージャモジュールは次のフォルダにあります。

   C:\Program Files\Common Files\McNeel Shared\License Manager

Rhino 3.0とRhino 4.0では異なるライセンスマネージャモジュールを使用しています:

  * Rhino 3.0 のライセンスマネージャ: **McNeelLM.exe**
  * Rhino 4.0 のライセンスマネージャ: **RhinoLM.exe**

お使いのRhinoバージョンのライセンスマネージャモジュールが見つからない場合、CDからRhinoを再インストールする必要があります。

\\

=====解決策3 - Windowsのシステムレジストリエントリが欠けている=====
お使いのRhinoバージョンのライセンスマネージャモジュールがある場合、そのモジュールが登録されていない可能性があり、Rhinoにこのモジュールを検索させる情報がWindowsのレジストリにはない可能性があります。この問題を解決するには:

  - ワークステーションに管理者または同等のユーザーとしてログインしていることを確認します。
  - ウィルス対策とスパイウェア対策が無効になっていることを確認します。
  - エクスプローラを使って先述のフォルダを開きます。（C:\Program Files\Common Files\McNeel Shared\License Manager）

==== Rhino 3.0====
エラーが**Rhino 3.0**で起こっている場合の手順:

  - **バッチファイルを[[http://en.wiki.mcneel.com/content/upload/files/REGISTER_MCNEELLM.zip|ダウンロード]]**し、同じフォルダに **McNeelLM.exe** として解凍します。
  - **Register_McNeelLM.bat** バッチファイルをダブルクリックします。
  - Windows Vistaをお使いの方はファイルを右クリックし、「管理者として実行」を選択してください。

バッチファイルはコマンドラインに結果を反映し、成功したかどうかを検証します。この方法で問題が解決したかどうかを確認するには、Rhino 3.0を実行してください。
==== Rhino 4.0および5.0====
エラーが**Rhino 4.0**で起こっている場合の手順:

  - **バッチファイルを[[http://en.wiki.mcneel.com/content/upload/files/REGISTER_RHINOLM.zip|ダウンロード]]** し、同じフォルダに**RhinoLM.exe**として解凍します。
  - **Register_RhinoLM.bat** バッチファイルをダブルクリックします。
  - Windows Vistaをお使いの方はファイルを右クリックし、「管理者として実行」を選択してください。

バッチファイルはコマンドラインに結果を反映し、成功したかどうかを検証します。この方法で問題が解決したかどうかを確認するには、Rhinoを実行してください。

\\

=====解決策4 - ランタイムライブラリのサポートファイルが欠けている=====
解決策3のバッチファイルを実行してもエラーが発生する場合はマイクロソフト最新のランタイムライブラリを**[[http://s3.amazonaws.com/mcneel/rhino/4.0/misc/vcredist_x86.exe|ダウンロード]]** し、インストールした上で再度お試しください。

=====解決策5 - 誤ったライセンスマネージャが実行中になっている=====
コンピューターを再起動してください。上記のステップで修正できた場合でも、Windowsで実行されている誤ったライセンスマネージャが引き続き問題を起こしてしまう可能性があります。再起動した後、Rhinoは動作しましたか？

=====解決策6 - Windows Vista レジストリのセキュリティの問題=====
お使いのRhinoバージョンのライセンスマネージャモジュールがあり、登録もされている場合、Windowsレジストリを読み取る権限がない可能性があります。

**Regedit.exe** を実行します。

//レジストリエディタは使い方を間違えると、Windowsを再インストールしないと修正できない、システム全体に及ぶ深刻な問題を引き起こす可能性があります。Robert McNeel & AssociatesおよびMicrosoftは、レジストリエディタを使った結果発生した問題を解決できるかどうか、一切保証することはできません。このツールはご自身の責任にてお使い下さい。//

レジストリエディタを開いたら、HKEY_CLASSES_ROOT にある**RhinoLicenseManager.RhinoLicense** キーを探してください。例えば:

    - **HKEY_LOCAL_MACHINE\Software\Classes** をブラウズします。
    - **Classes** キーを右クリックし、**アクセス許可** をクリックします。
    - 「セキュリティ」タブの**グループ名またはユーザー名**に、少なくとも4つのアクセス許可エントリが表示されているはずです。"ライセンスマネージャと通信できない" 問題はレジストリキーのClassesにアクセス許可がないために発生することがあります。 

**アクセス許可が欠けている<color blue>場合のみ</color>、追加します。**
    - **追加** ボタンをクリックします。
    - **Creator Owner** と入力し、**OK** をクリックします。
    - **Creator Owner** を選択し、Creator Owner のアクセス許可にある「許可」のチェックボックスをすべて外します。\\ {{:ja:rhino:lregedit01off.jpg|}}
    - **追加** ボタンをクリックします。
    - **SYSTEM** と入力し、**OK**をクリックします。
    - **SYSTEM** を選択し、SYSTEM のアクセス許可にある**フル コントロール** 許可のチェックボックスを選択します。\\ {{:ja:rhino:lregedit02.jpg|}}
    - **追加** ボタンをクリックします。
    - **Administrators** と入力し、**OK** をクリックします。
    - **Administrators** を選択し、Administrators のアクセス許可にある **フル コントロール** 許可のチェックボックスを選択します。\\ {{:ja:rhino:lregedit03.jpg|}}
    - **追加** ボタンをクリックします。
    - **Users** と入力し、**OK** をクリックします。
    - **Users** を選択し、Users のアクセス許可にある **読み取り** 許可のチェックボックスを選択します。\\ {{:ja:rhino:lregedit04.jpg|}}
    - **詳細設定** ボタンをクリックします。
    - **Classes のセキュリティの詳細設定** ダイアログボックスで、**全ての子孫の既存の継承可能なアクセス許可すべてを、このオブジェクトからの継承可能なアクセス許可で置き換える** チェックボックスを選択します。
    - **Classes のセキュリティの詳細設定** ダイアログボックスで、**このオブジェクトの親からの継承可能なアクセス許可を含める** チェックボックスを選択します。\\ {{:ja:rhino:lregedit05check.jpg|}}
    - **OK** をクリックします。この操作は完了するまで数分程度かかります。
    - **Classes のアクセス許可** ダイアログボックスで **OK** をクリックします。
  
これらのステップを試してもうまくいかない場合は、[[http://technet.microsoft.com/en-us/sysinternals/bb897553|PsExec]] を使ってシステムアカウントとして RegEdit を実行する必要があります。PsExecをダウンロードし、 //psexec -i -d -s c:\windows\regedit.exe// を実行してください。
  
これでRhinoを実行し、ライセンスマネージャと通信できるようになっているでしょう。