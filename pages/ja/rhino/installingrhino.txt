====== Rhinoのインストールオプション ======


> **Summary:** //Rhino 4または3の自動インストール方法について説明しています。また、インストールされる内容および場所についての詳細を載せています。//

====== Rhinocerosのインストール======
  * [[# Active DirectoryまたはSMSによる Rhino 4.0 MSIの展開]]
  * [[#Rhino 4.0 サービスリリースパッチの展開]]
  * [[#スクリプトを使用したRhino 4.0のインストール]]
  * [[#INIファイルとスクリプトを使用したRhino 4.0のインストール]]
  * [[#Rhino 4.0 高度な設定]]
  * [[#スクリプトを使用したRhino 3.0のインストール]]
  * [[#Rhino 3.0 インストールの詳細]]

======Active Directory またはSMSによる Rhino 4.0MSIの展開======
===== 概要=====
ここで紹介する手順は、主にActive DirectoryやSMSを使って、組織全体でRhino4.0を展開したいシステム管理者の方向けです。

これらのインストールは、カスタマイズされたRhino4Setup.iniを含むフォルダからMSIを実行することで、自動展開にも使用できます。[[# INIファイルによるスクリプトを使用したRhino 4.0のインストール]] をご覧ください。これには Active Directoryや SMS、その他の展開ツールは必要としません。

アプリケーション展開についてはここでは網羅しきれないため、ほとんどの展開特有の手順は省略しています。

===== 必要条件:=====
Active Directory またはSMSを使った展開にはRhino 4.0 サービスリリース1 （SR1、2007年7月3日）またはそれ以降の完全なインストーラが必要です。それ以前のRhino 4.0 にはインストーラにエラーがあるため、展開の途中で重要なアプリケーションコンポーネントのインストールができません。

お持ちのCD面にSR1、SR2などの表示がない方は、どうぞ **brian** **@** **mcneel** **.** **com**へご連絡の上、最新のCDを入手してください。


===== インストール済みRhino 4.0のアンインストール=====
**メモ:** 既にRhino 4.0がインストールされている対象システムでMSIを展開しようとすると、展開に失敗します。これは評価版およびベータ版リリースの以前のインストールを含みます。展開の前にまず既存のリリースをすべてアンインストールする必要があり、これらのコマンドラインはすべてのRhino 4.0バージョンを（SR4を通して）サイレントアンインストールします:

     msiexec /x{5C2CBFFD-FC3B-4AA9-993B-CE2B8DA25B87} /qn
     msiexec /x{D6F64D4F-B539-448E-A5D7-B57EE89193B8} /qn
     msiexec /x{761EC7CE-E646-4A8C-95DA-A24C6CDACF3F} /qn
     msiexec /x{D7960C39-E3FD-4B46-8E97-A1E9D128F913} /qn
     msiexec /x{D57F1897-D0F5-4E5F-99BA-80815B43283A} /qn

===== 展開の準備=====
1. ネットワーク共有場所へ管理者用インストールを実行します。この例では、場所を**S:\Rhino 4.0 SR1**と仮定します。例えばお持ちのRhino 4.0 SR1のCDがD:\ ドライブにある場合、次のコマンドラインから管理者用インストールを実行することができます: **msiexec.exe /a D:\rhinoceros\rhino4_setup.msi**

2. **[[http://wiki.mcneel.com/_media/legacy/en/Rhino4Setup.zip|Rhino4Setup.ini]]** ファイルを編集し、同じ管理者用インストールフォルダに保存して.msiファイルの名前と一致するよう名前を変更します。**メモ:** # 記号の後の文字は、#記号が行の中にあった場合でもすべてインストーラによって無視されます。構成の詳細については**[[http://jp.wiki.mcneel.com/default.aspx/McNeel/EditRhino4SetupIni|Rhino4Setup.iniの編集]]** をご覧ください。

3. **[[http://s3.amazonaws.com:80/mcneel/rhino/4.0/misc/MS-VC80.msi|MS-VC80.msi]]** をダウンロードし、**MS-VC80.msi** を管理者用インストールフォルダに保存します。

===== 展開の構成=====
  - **Active Directoryユーザーとコンピュータ** を開きます。
  - Rhino 4.0を受信するユーザーまたはコンピュータを含む、グループまたは組織単位を右クリックしてプロパティをクリックします。
  - グループポリシータブで、名前を**Install Rhino 4.0**とした新しいグループポリシーオブジェクトを追加します。
  - **Instal Rhino 4.0** グループポリシーオブジェクトを選択し、**編集...**をクリックします。
  - コンピュータごと、またはユーザーごとの（グループポリシーをよくお調べになった上で、ご自身の組織に最適な方法を選んで）いずれかを決定します。
  - ユーザーの構成またはコンピュータの構成（上記でどちらを選択したかによる）で**ソフトウェアの設定**を展開し、**ソフトウェアのインストール**を右クリックして**新規作成 -> パッケージ**をクリックします。
  - **S:\Rhino 4.0 SR1\MS-VC80.msi**を選択してインストールします。<color red>これはRhino 4.0 SR1 またはそれ以上</color><color red>の前にインストールする必要があります。</color>
  - **S:\Rhino 4.0 SR1\Rhino4_Setup.msi**を選択してインストールします。
  - ソフトウェアの展開ダイアログボックスで**割り当て**を選んでクリックします。
  - 右側のウィンドウに表示される Rhino 4.0 SR1を右クリックし、**プロパティ**をクリックします。
  - **ログオン時にこのアプリケーションをインストールする チェックボックス**を選択します。（またはご自身の組織での必要性に適した展開オプションをカスタマイズします。）

====== Rhino 4.0 サービスリリースパッチをActive Directory またはSMSを使用して展開======
*<color red>メモ:</color>** このテクニックを使うには、Rhino 4.0 SR1またはそれ以前が対象のコンピュータにインストール済みである必要があります。同時に**rh40sr**.exe**パッチインストーラも必要です。
  - パッチインストーラ（rh40sr_en_20071017.exeなど）をWinZipで開きます。
  - **Rhino4_Patch.msi**を展開し、保存します。
  - 上記MSI展開の説明に従います。Rhinoのインストールが正しく動作しなくなりますので、以前にインストールしたRhino 4.0を **アンインストールしないでください**。


====== スクリプトを使用したRhino 4.0のインストール（バッチファイル）======
以下のラインは手動で実行することができますが、バッチファイル（.bat）の一部として実行する方が便利です。

1. Rhino 4.0が対象のコンピュータにインストールされていないことを確認するか、インストールの前にこちらのラインを実行してください:

     msiexec /x{5C2CBFFD-FC3B-4AA9-993B-CE2B8DA25B87} /qn
     msiexec /x{D6F64D4F-B539-448E-A5D7-B57EE89193B8} /qn
2. **[[http://s3.amazonaws.com:80/mcneel/rhino/4.0/misc/MS-VC80.msi|MS-VC80.msi]]** をダウンロードし、こちらのラインを使って対象にインストールします

     msiexec /i"s:\RhinoInstallScripts\ms-vc80.msi /qn
3. （DドライブにあるRhino 4.0 CDからインストールする場合、）次のような内容のラインを実行します:

     msiexec.exe /i"d:\Rhinoceros\Rhino4_Setup.msi" AUTOINSTALL=1 FOLDER="C:\Progs\Rhino4" RMA_CDKEY=AAAABBBBCCCCDDDDEEEE INSTALL_EN=1

これらのパラメータ、およびその他考えられるものについての説明は**[[http://jp.wiki.mcneel.com/default.aspx/McNeel/EditRhino4SetupIni|Rhino4Setup.iniの編集]]** をご覧ください。



====== スクリプトおよびINIファイルを使用した Rhino 4.0のインストール======
このINI方式を使用する前に、Rhino 4.0 サービスリリース1 （2007年7月3日）またはそれ以降の完全なMSIインストーラを必ずご用意ください。お持ちのインストーラが.EXEファイルの場合は解凍して.MSIファイルを取り出してください。インストーラがCDにある場合はRhino 4.0 CDのRhinocerosフォルダから、ハードディスクまたは共有ネットワークのディスクにすべてのファイルをコピーします。

1. **[[http://wiki.mcneel.com/_media/legacy/en/Rhino4Setup.zip|Rhino4Setup.ini]]** ファイルを編集し、インストール処理を設定するパラメータのコメントを解除します。（ファイル拡張子の前の）INIファイル名をMSIファイルと同じ名前に変更し、両方を同じフォルダに保存します。

**メモ:** # 記号の後の文字は、#記号が行の中にあった場合でもすべてインストーラによって無視されます。構成の詳細についてはsee [[EditRhino4SetupIniをご覧ください。|Rhino4Setup.iniの編集]]

2. Rhino 4.0が対象のコンピュータにインストールされていないことを確認するか、インストールの前にこちらのラインを実行してください:

     msiexec /x{5C2CBFFD-FC3B-4AA9-993B-CE2B8DA25B87} /qn
     msiexec /x{D6F64D4F-B539-448E-A5D7-B57EE89193B8} /qn
     msiexec /x{761EC7CE-E646-4A8C-95DA-A24C6CDACF3F} /qn
     msiexec /x{D7960C39-E3FD-4B46-8E97-A1E9D128F913} /qn
     msiexec /x{D57F1897-D0F5-4E5F-99BA-80815B43283A} /qn
3. **[[http://s3.amazonaws.com:80/mcneel/rhino/4.0/misc/MS-VC80.msi|MS-VC80.msi]]** をダウンロードし、こちらのラインを使って対象にインストールします

     msiexec /i"s:\RhinoInstallScripts\ms-vc80.msi /qn
4. MSIファイルを起動すると自動的に同じフォルダにあるINIファイルを見つけてパラメータを読み込み、サイレントにインストーラを実行します。

例:

      msiexec.exe /i"F:\RhinoInstaller\Rhino4_SR1_20070808.msi"



====== Rhino 4.0の高度なカスタマイズ======
いくつかの設定が HKEY_LOCAL_MACHINE レジストリハイブから設定可能です。これらの設定はMSIの外で変更する必要があります。

> **Note:** //すべてのレジストリキーは、インストールしたRhinoのビルドと言語によって設定されます。例えば、2007年1月3日のビルドなら、<BUILD_DATE>は2007-01-03になります。英語のインストールなら、<LANG_ID>は1033になります。//

> **すべての設定は次のキーに含まれています:** ////
HKEY_LOCAL_MACHINE\Software\McNeel\Rhinoceros\4.0\<BUILD_DATE>\<LANG_ID>\

**テンプレートファイルの場所:**

レジストリ値 "Default Template Folder" を、ユーザーがテンプレートファイルを選択するフォルダへのフルパスを持つように変更します。

**デフォルトのテンプレート**

デフォルトのテンプレートファイルへのフルパスがある文字列値 "Default Template File" を追加します。

その他の設定も可能です。その他の構成の設定については上に挙げたレジストリキーをご覧ください。




----


====== Rhino 3.0の自動（スクリプトを使用した）インストール======
こちらの説明を**ご覧ください**: http://www.rhino3d.com/script.htm

> **こちらのウィキページもご覧ください:** //AutomateRhino3InstallerFromCustomInstaller//

> **メモ:** ////

> グループ・ポリシーを使用して展開できるよう、.exeではなく .msiファイルをインストーラとして入手することはできますか？
> Penguinなどのサービスリリースをネットワーク全体にインストールしたいのですが。

Rhino 4.0 と Flamingo 2.0についてはインストーラを.MSIに移行中ですが、Rhino 3.0では予定していません。 [パスカル（Pascal Golay）- 2005年11月10日]



====== Rhino 3.0をCD:からインストールした場合のフォルダ、レジストリについての詳細======

Rhinoのインストール時には、ベースになるフォルダを指定することができます。そのフォルダの中で、メインのプログラムファイルは//System//サブフォルダに、そして多くのプラグイン（*.rhpとサポートファイル）は//Plug-ins//サブフォルダにインストールされます。インストールされたそれぞれの言語には、各言語フォルダ（//English//など）が作成され、その中に//Help//、//Getting Started//、//Environment Maps//、//Scripts//、//Sample Models//、そして//Tutorials//サブフォルダが作成されます。

テンプレートとツールバーファイルは ...Documents and Settings\All Users\Application Data\McNeel\Rhinoceros\3.0 にインストールされます。テンプレートは各言語ごとに異なり、それぞれ独立したフォルダにインストールされます。

レジストリのエントリは//HKEY_LOCAL_MACHINE\SOFTWARE\McNeel\Rhinoceros\3.0//に作成されます。//3.0//キーの中は//2004-04-21//のように、Rhinoの日付でサブキーが作成され、その日付のRhinoのエントリが配置されます。

日付のキーの中にある//Plug-ins//キーには、//12D31EFD-D3EE-4BCF-A856-D01320BB19F3//のようにサブキーが作成されます。これらのサブキーは、各プラグインに1つ作成されます。これらのキーと中の値によって、Rhino起動時にプラグインが読み込まれます。

日付のキーの中に作成される//<locale_ID>//（英語の場合は//1033//）には、ヘルプなどの言語リソースへのパスが含まれています。

いくつかのエントリは//HKEY_CURRENT_USER\SOFTWARE\McNeel\Rhinoceros\3.0//に作成されます。ここにはRhinoのオプションが保存されます。ほとんどは//Scheme: Default//サブキーに保存されます。スキームについての詳細はヘルプをご覧ください。//HKEY_CURRENT_USER\SOFTWARE\McNeel\Rhinoceros\3.0\Global Options//キーには、すべてのスキームに適用されるいくつかの設定が含まれています。



