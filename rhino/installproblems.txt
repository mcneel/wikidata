====== Troubleshooting Rhino 5 Installation ======
> This article is for Rhino 5. A similar article is available for [[http://wiki.mcneel.com/rhino/installproblems_legacy|Rhino 3 and 4]].

**Note -** Nearly all of the problems and fixes listed on this page can be avoided if you start with getting Windows fully up to date with **important updates** using **Windows Update**, before installing Rhino.\\

**Reporting Install Problems -**
The Rhino V5 installer will display a log file when the installation process fails.  This log file is very helpful to our technical support in solving any problems you may have. 
  - When the error message appears, there is a link on the dialog. 
  - Click the link to open the log and "Save As.." as a txt file.
  - Attach the text file to an email to [[tech@mcneel.com]]

===== General =====

**{{topic>Rhino5Installation}}**
--
**{{topic>Rhino5Installation_en}}**

===== Error Messages =====

-->Error 1603#
A wide variety of problems can cause {{anchor:error:1603}} errors. Please follow all of the steps below.
\\
\\
**Step 1: Install .NET 4.0 Framework**
  - Open **Windows Explorer** and browse to the Rhino Installer DVD
  - Open the **Installers\Prerequisites** folder.
  - Run the [[http://www.microsoft.com/en-us/download/details.aspx?id=17718|dotNetFx40_Full_x86_x64.exe]].
  - If the Microsoft .NET installer **shows an error**: 
    - write down the error 
    - **Proceed to Step 2**.
  - 64-bit Windows XP Only:
    - Download and install [[http://www.microsoft.com/en-us/download/details.aspx?id=8483|Windows Installer 4.5 Redistributable]]
  - **Skip to Step 3**.
\\
**Step 2: Perform Windows Updates**
  - Run the [[http://windows.microsoft.com/en-US/windows/help/windows-update|Windows Update service]]
  - If there are any important updates to install, click on **Update Now** to install the updates.  This process can take a long time.
  - If there is an error when trying to run Windows update installer, please read [[http://support.microsoft.com/kb/906602|Troubleshooting common Windows Update Issues]]
  - If you resolve the Windows update problem and finish running [[http://windows.microsoft.com/en-US/windows/help/windows-update|Windows Update service]], then **return to Step 1**.
\\
**Step 3: Install Rhino**
  - Open **Windows Explorer**
  - Browse to the Rhino 5 DVD
  - Double-click **Setup.exe** to start the Rhino 5 installation process.
  - If the Rhino 5 installer fails, save a copy of the log file to your desktop.
  - **Proceed to Step 4**
\\
**Step 4: Manual Installation**
  - Open **Windows Explorer**
  - Browse to the **Installers** folder of the Rhino 5 DVD
  - For //64-bit systems only//: double-click **rhino5setup_en-us_x64.msi** and complete the installation
  - For all systems: 
      - double-click **rhino5setup_en-us_x86.msi** and complete the installation
      - double-click **LanguagePack_en-us.msi** (and any other languages you wish to install)
      - double-click **HelpMedia.msi**
  - If you experience errors during installation:
    - Write down any error numbers and messages you see
    - Email the step you are on in this article and any errors to tech@mcneel.com
  - Restart Windows if prompted.
  - **Start Rhino 5**
  - In the Rhino 5 command line, type **ToolbarReset** then press Enter.
  - **Close Rhino 5**
  - **Start Rhino 5**
  - **Installation is complete!**
\\
**Still not working?**
  - That's frustrating - we're sorry!
  - Please email any log files from Step 3 to tech@mcneel.com

<--

-->Error 1327 - Invalid Drive:#
**//Question://** //I get "Error 1327. Invalid Drive (E:, F:, etc)" when installing//

**//Cause://** //Your user account has settings indicating that one or more non-existent drives should be used for special folders such as "My Documents"//

**//Solution://**
  - From the Start menu, click Run.
  - Type RegEdit, then click Run
  - Browse to HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders
  - Look for directories listed that contain the drive letter mentioned in the error from the installer. Change them to point to a valid drive and folder.
  - Browse to HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders
  - Look for directories listed that contain the drive letter mentioned in the error from 

**Note:** This method, or task contains steps that tell you how to modify the registry. However, serious problems might occur if you modify the registry incorrectly. Therefore, make sure that you follow these steps carefully. For added protection, back up the registry before you modify it. Then, you can restore the registry if a problem occurs. For more information about how to back up and restore the registry, click the following article number to view the article in the Microsoft Knowledge Base:
[[http://support.microsoft.com/kb/322756|How to back up and restore the registry in Windows ]]

<--

-->Error 1402 or 1406 (Could not open key: UNKNOWN\Components)#
** //Question://** // A message "Could not open key: UNKNOWN\Components\(lots of letters and numbers). Error 1402. Verify that you have sufficient access to that key, or contact your support personnel."//

**//Cause://** One or more registry keys in the HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-<numbers>\Components key has incorrect permissions.

**//Solution 1://**
On the Windows Start menu, enter "CMD" to the search box. Right-click on the "cmd.exe" and select "Run as administrator". Copy the following line and paste it into the cmd window, press Enter. Then Rhino will be able to install.

<code>
secedit /configure /cfg %windir%\inf\defltbase.inf /db defltbase.sdb /verbose
</code>

**//Solution 2://**
//WARNING: The following procedure involves editing the Windows Registry. Incorrect editing of the registry can damage your computer and cause it to not start. If you are not comfortable performing the following steps, please contact McNeel Support.//
  - Download [[http://technet.microsoft.com/en-us/sysinternals/bb897553|psexec]] from Microsoft TechNet, and extract the contents to your desktop.
  - Open a Windows command shell
  - Change directories to your desktop.
  - In the command shell, enter: **psexec -i -d -s c:\windows\regedit.exe** This causes Windows to run the registry editor with the permissions of the System account - an account even more powerful than Administrator.
  - Browse to HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Installer\UserData\
  - Right-click the **UserData** folder, then click **Permissions...**
  - In the Permissions for UserData dialog box, click **Advanced**
  - Ensure that "Administrators" has "Full Control" Permissions in this folder, and that "Users" has "Read" Permissions. There will be other user permissions, too - but Administrators and Users are what matter most.
  - Select the **Replace all child object permissions with inheritable permissions from this object**
  - Click **OK** twice to apply permissions
  - Install Rhino again.

<--

-->Error 1921#
**//Question://** The log file shows "Error 1921.  (1)Service 'McNeel Update Service 5.0' (McNeelUpdate) could not be stopped. Verify that you have sufficient privileges to stop system services."
\\
\\
**//Solution 1://**
  * **Reboot Windows and run the installer again.** The Update Service starts when Rhino is launched so it will not be running after a restart.
\\ 
**//Solution 2://**
  * **Manually stop the service**
    - Run services.msc. 
    - Find "McNeel Update Service 5.0"
    - Right-click and choose Properties
    - Change Startup type from Automatic to Disabled
    - Close Services
    - Restart Windows
    - Install Rhino
    - Run Services.msc again
    - Change the Startup type for "McNeel Update Service 5.0" back to Automatic

<--

-->Error 1935#
**//Question://** //I get "Error 1935. An error occurred during the installation of assembly "Microsoft.VC80.CRT, ..."//

**//Cause://** //This is a bug in the Microsoft C++ 2005 Redistributable Package//

**//Solution 1://**
  * **Update Windows** Several users have reported that running Windows Update fixed the problem.
**//Solution 2://**
  * **Disable the antivirus program on the system.** A user reported disabling AVG made Rhino installation work.
**//Solution 3://**
  * **Try to install several times.** A user reported Rhino installation succeeded when the third time he tried to install Rhino. He didn't do anything to the system.
**//Solution 4://**
  - On Windows Vista or Windows 7, From the Start menu, type Features.
  - Click **Turn Windows Features On or Off**
  - In the Windows Features dialog box, select the check box labeled **Windows Communication Foundation HTTP Activation**:
  - {{:rhino:rhino_1935_windows_features.png|}}
  - Click OK

If you are unable to enable this feature, or if the Windows Features dialog box appears and is empty, then your installation of Windows is corrupt and needs to be repaired. Please contact Microsoft Support for more assistance.

**//More Details://**
People who get this error while installing Rhino are also unable to install the [[http://www.microsoft.com/downloads/en/details.aspx?FamilyID=32bc1bee-a3f9-4c13-9c99-220b62a191ee&displaylang=en|Microsoft C++ 2005 Redistributable Package directly]] from Microsoft. Therefore, this is a problem with Windows and the Microsoft Redistributable Package, not with Rhino's installer.

<--

-->Error 2502#
**//Question://** When Rhino 5 prompts there's a new update ready to install, choose to install the update and get "Error 2502".

**{{http://wiki.mcneel.com/_media/rhino/k01373.png?400}}**

**//Cause://** The update installer doesn't have enough permission privileges.

**//Solution://**
  - Right-click on Rhino 5 shortcut icon.
  - Select "Run as Administrator".
  - Rhino 5's start plane prompts there's a new update ready to install.
  - Choose to install the update.

<--

-->.NET Framework 4 Required: Rhino 5 installer keeps asking for .NET Framework 4#
**Problem:**\\ Rhino 5 installer keeps asking for installing .NET Framework 4 first, and Rhino 5 fails to install. The .NET Framework 4 appears to exist on the computer.

**Cause:**\\ .NET Framework 4 is somehow broken on the system.

**Solution:**
  - Download <color #999999>[[http://files.na.mcneel.com/misc/dotnetfx_cleanup_tool.zip|.NET Framework Cleanup tool]]</color>.
  - Run .NET Framework Cleanup tool.
  - Select **.NET Framework - All versions** for the product to cleanup.\\ {{http://wiki.mcneel.com/_media/rhino/rhino5/k01521.png?w=405}}
  - Click the **Cleanup Now** button.
  - Reboot your computer.
  - Install Rhino 5 from your Rhino 5 DVD.\\ <color #999999>The Rhino 5 DVD installer will install .NET Framework 4 first and then install Rhino 5.\\ If you are installing </color><color black>Rhino 5 evaluation version</color><color #999999>, you'll need to [[http://www.microsoft.com/en-us/download/details.aspx?id=17718|download]] and re-install .NET Framework 4 full version before installing Rhino 5. </color>

<--

-->.NET Framework 4 error: (HRESULT: 0xc8000222)#
**Problem:**\\ .NET Framework 4 failed to install because of error code HRESULT: 0xc8000222.

**Cause:**\\ Some files corrupted in the **Software Distribution folder**.

**Solution:**
  - Download [[http://files.na.mcneel.com/misc/Fix_0xc8000222.zip|Fix_0xc8000222.zip]].
  - Extract the **Fix_0xc8000222.bat** in the zip file to a folder.
  - Right-click on the Fix_0xc8000222.bat and select **Run as Administrator**.\\ <color #999999>What this batch file does:\\ 1) Disables </color><color black>Windows Update Service</color><color #999999>.\\ 2) Deletes </color><color black>C:\Windows\SoftwareDistribution</color><color #999999>.\\ 3) Enables </color><color black>Windows Update Service</color><color #999999> again.</color>

<--

-->.NET Framework 4 error: (exit code -2145124330)#
**//Problem://** I get a .NET Framework 4.0 installer error while installing Rhino 5.

**//Solution://** Repair .NET Framework before installing Rhino 5.
  - Download [[http://www.microsoft.com/en-us/download/details.aspx?id=30135|Microsoft .NET Framework Repair Tool]].
  - Run the repair tool.
  - Keep clicking the "Next" button until you get only one "Finish" button to click.
  - Install Rhino 5 again.

<--

-->Error: A DLL required for this install to complete could not be run.#
Problem: Installation fails with a missing dll message like: 

**//There is a problem with the Windows Installer package. A DLL required for this install to complete could not be run. Contact your support personnel or package vendor//**

Solution: It may be that a virus scanner is getting in the way- try disabling any virus scanners and retry the installation. Or your system may be missing important **Windows Updates**. 
  * //To see how to check for Windows updates [[http://wiki.mcneel.com/windows_updates|here.]]//

<--

-->Windows 7/8 is not a supported system?#
**Problem:**\\ I'm using Windows 7/8, but Rhino 5 installer says my system is not supported.\\ \\ 

**Cause:**\\ Rhino installation was canceled by any reasons.\\ Windows **Program Compatibility Assistant (PCA)** appeared.\\ {{http://wiki.mcneel.com/_media/rhino/rhino5/pca.png}}\\ You selected **Reinstall unsing recommended settings**.\\ Windows applied **Windows XP SP2** compatibility mode to the Rhino installer.\\ 

**Solution:**\\ 
  - Right-click on the **Rhino installer**, select **Properties**.\\ <color #999999>If your Rhino installer was downloaded from Rhino website, the installer has a name similar to **rh50_xx-xx_5.8.40315.18095.exe**.\\ If you are installing Rhino from a DVD, the installer is the **setup.exe** in the root folder of the DVD. </color>
  - Go to the **Compatibility** tab.\\ <color #999999>The compatibility mode may be set to "Windows XP (Service Pack 2)" and can't be changed.</color>
  - Click the **Change settings for all users** button near the bottom.
  - Clear the **Run this program in compatibility mode** checkbox. 
  - Click **OK** two times to close the dialogs.
  - Right-click on the exe installer again and select **Run as administrator** to install.

<--

-->Error: Rhino is unable to connect to ZooClient.dll#
**Problem:**\\Rhino 5 shows a message “Rhino is unable to connect to ZooClient.dll. Rhino will not run”

**Solution:**\\
http://wiki.mcneel.com/rhino/rhino5/zooclient.dll

<--

-->Error: Script Error - ! An error has occurred in the script on this page.
**Problem:**\\Running the DVD based installer, this error is displayed:
{{:rhino:rhino5:installer_stript_error.png?direct&200|}}

**Solution:**\\
  - Download and run the latest Full Version - Rhino V5 installer from:\\http://www.rhino3d.com/download

<--

{{tag>rhino5installation}}