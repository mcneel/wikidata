====== 佈署 Rhino ======


Summary 摘要: How to install Rhino 4 or 3 automatically; Details on what gets installed and where. 如何自動地安裝Rhino4 或 Rhino3

======Installing Rhinoceros======
  * [[#Rhino 4.0 MSI Deployment with Active Directory or SMS]]
  * [[#Rhino 4.0 Service Release Patch Deployment]]
  * [[#Rhino 4.0 Scripted Install]]
  * [[#Rhino 4.0 Scripted Install with INI File]]
  * [[#Rhino 4.0 Advanced Configuation]]
  * [[#Rhino 3.0 Scripted Install]]
  * [[#Rhino 3.0 Install Details]]

======Rhino 4.0 MSI Deployment with Active Directory or SMS======
=====Overview 總攬=====
These instructions are most useful for System Administrators who want to deploy Rhino 4.0 througout an organization using Active Directory or SMS.

These techniques will also work for automated installation by running the MSI from a folder that contains a customized Rhino4Setup.ini. See [[#Rhino 4.0 Scripted Install with INI File]] This does not require Active Directory, SMS, or other deployment tools.

Documentation of application deployment is beyond the scope of this article, so most deployment-specific instructions have been omitted.

=====Requirements: 安裝需求=====
You must have a full installer for Rhino 4.0 Service Release 1 (SR1, 3-Jul-2007) or newer to deploy using Active Directory or SMS. Previous releases of Rhino 4.0 had errors in the installer that would fail to install critical application components during the deployment.

Please contact **brian** **@** **mcneel** **.** **com** to obtain a current CD if yours doesn't have SR1, SR2, etc. on the CD face. 請與**brian** **@** **mcneel** **.** **com**聯繫以取得最新版安裝光碟，如果你的光碟上沒有印有SR1, SR2,等等的字樣。


=====Uninstalling Previous Installations of Rhino 4.0=====
**Note:** If you try to deploy the MSI with Rhino 4.0 already installed on the target system, it will fail. This includes previous installations of Evaluation and Beta releases. You must first uninstall any existing release prior to deployment, these command lines will uninstall (through SR4) any Rhino 4.0 versions (through SR4) silently:

     msiexec /x{5C2CBFFD-FC3B-4AA9-993B-CE2B8DA25B87} /qn
     msiexec /x{D6F64D4F-B539-448E-A5D7-B57EE89193B8} /qn
     msiexec /x{761EC7CE-E646-4A8C-95DA-A24C6CDACF3F} /qn
     msiexec /x{D7960C39-E3FD-4B46-8E97-A1E9D128F913} /qn
     msiexec /x{D57F1897-D0F5-4E5F-99BA-80815B43283A} /qn

=====Deployment Preparation 佈署準備=====
1. Perform an administrative install to your network share location. For this example, we'll assume the location **S:\Rhino 4.0 SR1**  For example, if your Rhino 4.0 SR1 CD is in the D:\ drive, you can perform an administrative install from the command line: **msiexec.exe /a D:\rhinoceros\rhino4_setup.msi**

2. Edit the **[[http://en.wiki.mcneel.com/content/upload/files/Rhino4Setup.zip|Rhino4Setup.ini]]** file and place it in the same administrative install folder and change its name to match the name of the .msi file. **Note:** All characters following a # sign are ignored by the installer, even if the # character appears in the middle of a line. For more configuration details, see **[[EditRhino4SetupIni|Editing Rhino4Setup.ini]]**

3. Download **[[http://s3.amazonaws.com:80/mcneel/rhino/4.0/misc/MS-VC80.msi|MS-VC80.msi]]** and save **MS-VC80.msi** in the administrative install folder.

=====Deployment Configuration 佈署設定=====
  - Open **Active Directory Users & Computers**
  - Right-click the Group or Organizational Unit that contains the users or computers that will receive Rhino 4.0, then click Properties.
  - In the Group Policy tab, add a new Group Policy Object named **Install Rhino 4.0**
  - Select the **Instal Rhino 4.0** Group Policy Object, then click **Edit...**
  - Determine whether you will be installing per-computer or per-user (read up on Group Policy to determine which works best for your organization).
  - Under User Configuration or Computer Configuration (depending on how you chose in the last step), expand **Software Settings**, then right click **Software installation**, then click **New -> Package**.
  - Select **S:\Rhino 4.0 SR1\MS-VC80.msi** to install. <color red>This must be installed before Rhino 4.0 SR1 or above.</color>
  - Select **S:\Rhino 4.0 SR1\Rhino4_Setup.msi** to install.
  - In the Deploy Software dialog box, select **Assigned**, then click OK.
  - Right-click Rhino 4.0 SR1 in the right pane, then click **Properties**.
  - Select the **Install this application at logon checkbox.** (Or customize the deployment options to fit the needs of your organization).

======Deploying Rhino 4.0 Service Release Patch via Active Directory or SMS======
*<color red>Note:</color>** You must have Rhino 4.0 SR1 or earlier already installed on the target machines to use this technique. You must also have a **rh40sr**.exe** patch installer available.
  - Open the patch installer (such as rh40sr_en_20071017.exe) using WinZip.
  - Extract **Rhino4_Patch.msi** and save it.
  - Follow the MSI deployment instructions above. **DO NOT uninstall** previous installations of Rhino 4.0, or the resulting Rhino installation will not work properly.


======Rhino 4.0 Install with Script (batch file)======
The lines below can be executed manually, or more conveniently, as part of a batch (.bat) file

  - Make sure Rhino 4.0 is not installed on the target computer, or execute these lines before the install:
     msiexec /x{5C2CBFFD-FC3B-4AA9-993B-CE2B8DA25B87} /qn
     msiexec /x{D6F64D4F-B539-448E-A5D7-B57EE89193B8} /qn
  - Download **[[http://s3.amazonaws.com:80/mcneel/rhino/4.0/misc/MS-VC80.msi|MS-VC80.msi]]** and install it on the target with
     msiexec /i"s:\RhinoInstallScripts\ms-vc80.msi /qn
  - Execute a line with content like this (this assumes you are installing from the Rhino 4.0 CD on your D drive):
     msiexec.exe /i"d:\Rhinoceros\Rhino4_Setup.msi" AUTOINSTALL=1 FOLDER="C:\Progs\Rhino4" RMA_CDKEY=AAAABBBBCCCCDDDDEEEE INSTALL_EN=1

For an explanation of these parameters, and the other possible ones, see **[[EditRhino4SetupIni|Editing Rhino4Setup.ini]]**



======Rhino 4.0 Install with Script and INI File======
You must have a full MSI installer file for Rhino 4.0 Service Release 1 (3-Jul-2007) or newer to use this INI method.  If the installer you have is an .EXE file, unzip it to get the .MSI file.  If your installer is on CD, copy all the files from the Rhinoceros folder of the Rhino 4.0 CD into a folder on your hard disk or shared network disk.

1. Edit the **[[http://en.wiki.mcneel.com/content/upload/files/Rhino4Setup.zip|Rhino4Setup.ini]]** file to uncomment the parameters of that you want to set for the installation process. Rename the INI file so it has the same filename (before the file extension) as the MSI file, and put them in the same folder.

**Note:** All characters following a # sign in a line are ignored by the installer, even if the # character appears in the middle of a line. For more configuration details, see [[EditRhino4SetupIni|Editing Rhino4Setup.ini]]

2. Make sure Rhino 4.0 is not installed on the target computer, or execute these lines before the install:

     msiexec /x{5C2CBFFD-FC3B-4AA9-993B-CE2B8DA25B87} /qn
     msiexec /x{D6F64D4F-B539-448E-A5D7-B57EE89193B8} /qn
     msiexec /x{761EC7CE-E646-4A8C-95DA-A24C6CDACF3F} /qn
     msiexec /x{D7960C39-E3FD-4B46-8E97-A1E9D128F913} /qn
     msiexec /x{D57F1897-D0F5-4E5F-99BA-80815B43283A} /qn
3. Download **[[http://s3.amazonaws.com:80/mcneel/rhino/4.0/misc/MS-VC80.msi|MS-VC80.msi]]** and install it on the target with

     msiexec /i"s:\RhinoInstallScripts\ms-vc80.msi /qn
4. Launch the MSI file and it will automatically find the INI file in the same folder, read the parameters from it, and run the installer silently.

> **Example:** ////
      msiexec.exe /i"F:\RhinoInstaller\Rhino4_SR1_20070808.msi"



======Advanced Customization for Rhino 4.0======
Several settings are configurable from the HKEY_LOCAL_MACHINE registry hive. These settings must be modified outside the MSI:

> **Note:** //All registry keys are specific to the build and language of the Rhino you installed. For a build 3-Jan-2007, <BUILD_DATE> would be 2007-01-03. For English installations, the <LANG_ID> is 1033.//

All settings are in the key:

HKEY_LOCAL_MACHINE\Software\McNeel\Rhinoceros\4.0\<BUILD_DATE>\<LANG_ID>\

**Template File Location:**

Change the registry value "Default Template Folder" to have the full path to the folder where your users will select template files.

**Default template**

Add a string value titled "Default Template File" with the full path to the default template file.

Other settings are also available. See the registry key listed above for other configurable settings.




----


======Automatic (scripted) installation for Rhino 3.0======
**See** instructions at http://www.rhino3d.com/script.htm

Also see the Wiki page AutomateRhino3InstallerFromCustomInstaller

> **Note:** ////

> Is it possible to get .msi files for the installers rather that .exe for deployment with Group Policy?
> It would be great to update Service Releases install Penguin etc across our network.

We are moving over to .MSI installers for Rhino 4.0 and Flamingo 2.0, but Rhino 3.0 is not using them. [Pascal Golay - 2005-11-10]



====== What gets changed when I install Rhino 3.0 from CD:======

The user chooses a base folder for the Rhino install. The main program files go into the //System// subfolder, the many plug-ins (*.rhp and supporting files) go in the //Plug-ins// subfolder, and for each language installed, a language folder (like //English//) is created, with subfolders //Help//, //Getting Started//, //Environment Maps//, //Scripts//, //Sample Models// and //Tutorials//.

Template and toolbar files are installed under ...Documents and Settings\All Users\Application Data\McNeel\Rhinoceros\3.0  The templates are different for each language, in separate folders.

Registry entries are made in //HKEY_LOCAL_MACHINE\SOFTWARE\McNeel\Rhinoceros\3.0//    Under the //3.0// key is a subkey for the date of Rhino, like //2004-04-21// where the entries for that date of Rhino are placed.

The key //Plug-ins// under the date key has subkeys like //12D31EFD-D3EE-4BCF-A856-D01320BB19F3//, which is unique for each plug-in.  This key and the keys and values in it trigger Rhino to load the plug-in when Rhino launches.

The key //<locale_ID>// (like //1033// for English) under the date contains the paths for finding the English language resources like Help.

A few entries are made in //HKEY_CURRENT_USER\SOFTWARE\McNeel\Rhinoceros\3.0//, and this is where Rhino saves its Options, mostly under the subkey //Scheme: Default//   For more on Schemes see the Help file. The //HKEY_CURRENT_USER\SOFTWARE\McNeel\Rhinoceros\3.0\Global Options// key has a few settings that apply to all schemes.





