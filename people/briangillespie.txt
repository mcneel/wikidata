====== Brian Gillespie ======

=====About Brian=====

Brian is the [[rhino:home|Rhino]] product manager, among other things.

Will write [[http://www.perl.org/|PERL]] for food.

=====Scripts:=====

[[developer:scriptsamples:randomcolorscript|RandomColorScript]]




======Level 1======
This is level 1 text.
=====Level 2=====
This is level 2 text
====Level 3====
This is level 3 text
===Level 4===
This is level 4 text
==Level 5==
This is level 5 text
=Level 6=
This is level 6 text





-->Title#
Body
--> Sub Title#
Sub Body
<--
<--



====== Troubleshooting Installer Issues for Rhino 5 ======
For help with Installer Issues for Rhino 3 or Rhino 4, go [[http://wiki.mcneel.com/rhino/installproblems_legacy|here.]]

  * [[InstallingRhino|Deploying Rhino - Information on Silent/Scripted installs, Details of folders and registry, MSI Script, etc.]]
  * [[#Reporting Rhino 5 Installer Problems|Reporting Rhino 5 Installer Problems]]\\
  * [[#Rhino 5 Installer Error 1603 and others|Rhino 5 Installer Error 1603 and others]]\\
  * [[#Manually Uninstalling Rhino 5|Manually Uninstalling Rhino 5]]\\
  * [[#Could not open key: UNKNOWN\Components (Error 1402 or 1406)|Could not open key: UNKNOWN\Components (Error 1402 or 1406)]]
  * [[#Rhino 5 Uninstall Fails|Rhino 5 Uninstall Fails]]
  * [[#Installing the Latest Service Releases on a New Computer|Installing the Latest Service Releases on a New Computer]]
  * [[#What is a Service Release?|What is a Service Release?]]
  * [[#How do I get a Service Release?|How do I get a Service Release?]]
  * [[#Rhino 5 Install Never Completes|Rhino 5 Install Never Completes]]
  * [[#Error 1327 - Invalid Drive:|Error 1327 - Invalid Drive:]]
  * [[#Error 1603 - XP x64|Error 1603 - XP x64]]
  * [[#Error 1935|Error 1935]]
  * [[#Error 2502|Error 2502]]
  * [[#.NET Framework 4 installer error (HRESULT: 0xc8000222)|.NET Framework 4 installer error (HRESULT: 0xc8000222)]]
  * [[#Rhino 5 installer keeps asking for .NET Framework 4|Rhino 5 installer keeps asking for .NET Framework 4]]
  * [[#.NET Framework 4 installer error (exit code -2145124330)|.NET Framework 4 installer error (exit code -2145124330)]]
  * [[#Missing DLL]]
  * [[#Windows 7/8 is not a supported system?|Windows 7/8 is not a supported system?]]
  * [[#Installer reports WinXP not supported when running Win7/8?|Installer reports WinXP not supported when running Win7/8?]]
  * [[#Rhino V5 64-bit will not run but V5 32-bit will|Rhino V5 64-bit will not run but V5 32-bit will]]


-->Reporting Rhino 5 Installer Problems#
The Rhino V5 installer will display a log file when the installation process fails.  This log file is very helpful to our technical support in solving any problems you may have. 
  - When the error message appears, there is a link on the dialog. 
  - Click the link to open the log and "Save As.." as a txt file.
  - Attach the text file to an email to [[tech@mcneel.com]]
[[http://wiki.mcneel.com/rhino/installproblems|Back to top.]]
<--

-->Rhino 5 Installer Error 1603 and others#
The **Error Code 1603** is not a specific crash error, but is a general error in the installation process.  Some of the conditions that can cause 1603 are:
  * Short file name creation is disabled on the target machine.
  * An Install Script custom action is prototyped incorrectly.
  * A file is locked and cannot be overwritten.
  * The Microsoft Windows Installer Service is not installed correctly.
  * The Windows Temp folders are full.
  * The setup was corrupted after installation and, therefore, fails with this error during un-installation.
If the Rhino installer crashes with a 1603 error or no error code at all you can try these steps to get more information.

**//Step 1//**
  - Follow the steps above under Reporting Rhino V5 Installer Problems to send us the Install Log. 
  - Close the existing installer
  - Go to Windows Explorer and navigate to the contents of the Rhino Installer DVD
  - Open the Installer folder on the DVD
  - Open the Prerequisites folder.
  - Run the [[http://www.microsoft.com/en-us/download/details.aspx?id=17718|dotNetFx40_Full_x86_x64.exe]] installer in the folder.
  - If the dotNet installer shows an error, take note of the error and go to Step 2.
  - If the dotNet installer is successful, go to Step 3.

**//Step 2//**
  - Click here to run the [[http://windows.microsoft.com/en-US/windows/help/windows-update|Windows Update service]]
  - If there are any important updates to install, click on Update Now to install the updates.  This process can take a long time.
  - If there is an error when trying to run Windows update installer, see this article [[http://support.microsoft.com/kb/906602|Troubleshooting common Windows Update Issues]]
  - If you resolve the Windows update problem and finish running [[http://windows.microsoft.com/en-US/windows/help/windows-update|Windows Update service]], then return to Step 1.

**//Step 3//**
  - Go to the Rhino installer DVD with Windows Explorer
  - Try and run the Setup.exe in the root of the DVD.
  - The installation should now complete.
  - If the Installer continues to crash, please attach the log file to an email to tech@mcneel.com. Or continue onto Step 4

**//Step 4//**
  - Go to the Rhino installer DVD with Windows Explorer
  - For 64-bit systems, run the file D:\Installers\rhino5setup_en-us_x64.msi
  - For all systems then run 
      - D:\Installers\rhino5setup_en-us_x86.msi
      - Run the language specific (LanguagePack) installer. For instance the English installer is D:\Installers\LanguagePack_en-us.msi
      - D:\Installers\HelpMedia.msi
      - Note: for 64-bit systems you will have run all 4 installers.
  - Restart Windows if prompted.
  - The last step is to start Rhino and type ToolbarReset on the commandine.  This will complete the install.

<--

-->Manually Uninstalling Rhino 5#
**//Question://** I tried to uninstall Rhino 5, but an error occurred and Rhino could not be removed.

**//Answer://** [[rhino/5/uninstall|Manually remove Rhino 5.]]
<--

-->Could not open key: UNKNOWN\Components (Error 1402 or 1406)#
** //Question://** // A message "Could not open key: UNKNOWN\Components\(lots of letters and numbers). Error 1402. Verify that you have sufficient access to that key, or contact your support personnel."//

**//Cause://** One or more registry keys in the HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-<numbers>\Components key has incorrect permissions.

**//Solution 1://**
On the Windows Start menu, enter "CMD" to the search box. Right-click on the "cmd.exe" and select "Run as administrator". Copy the following line and paste it into the cmd window, press Enter. Then Rhino will be able to install.

<code>
secedit /configure /cfg %windir%\inf\defltbase.inf /db defltbase.sdb /verbose
</code>

**//Solution 2://**
//WARNING: The following procedure involves editing the Windows Registry. Incorrect editing of the registry can damage your computer and cause it to not start. If you are not comfortable performing the following steps, please contact McNeel Support.//
  - Download [[http://technet.microsoft.com/en-us/sysinternals/bb897553|psexec]] from Microsoft TechNet, and extract the contents to your desktop.
  - Open a Windows command shell
  - Change directories to your desktop.
  - In the command shell, enter: **psexec -i -d -s c:\windows\regedit.exe** This causes Windows to run the registry editor with the permissions of the System account - an account even more powerful than Administrator.
  - Browse to HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Installer\UserData\
  - Right-click the **UserData** folder, then click **Permissions...**
  - In the Permissions for UserData dialog box, click **Advanced**
  - Ensure that "Administrators" has "Full Control" Permissions in this folder, and that "Users" has "Read" Permissions. There will be other user permissions, too - but Administrators and Users are what matter most.
  - Select the **Replace all child object permissions with inheritable permissions from this object**
  - Click **OK** twice to apply permissions
  - Install Rhino again.
[[http://wiki.mcneel.com/rhino/installproblems|Back to top.]]
<--

-->Rhino 5 Uninstall Fails#
**PROBLEM:**
This can be caused by a corrupt installer cache on your computer.

**SOLUTION:**
Follow the instructions in the article [[rhino:5:uninstall|Manually Uninstalling Rhino 5.0]]
\\
[[http://wiki.mcneel.com/rhino/installproblems|Back to top.]]
<--

-->Installing the Latest Service Releases on a New Computer#

**//Question://** //I've got a new computer and I want to install Rhino version **X** SR **Y**.  I have always purchased upgrade versions of Rhino.  Do I have to install ALL previous versions and sucessive service packs??//

**//Answer://**  Simply install the last upgrade version you have on CD.  During the install, you will be asked to insert the CD of a previous version to validate that you have it, but it is not necessary to actually **INSTALL** the previous versions.  Once you have installed the last CD version, proceed to install the latest Service Release - it is not necessary to install previous ones.
<--

-->What is a Service Release?#
Service releases are no-charge, maintenance releases that patch existing installations of software with the latest bug fixes and updates. These installers are downloadable and will only install if you have a version of the product already installed.  Service Releases are identified two ways: the SR number, like SR3 or SR4b; and the date, which is coded into the name of the download file like 20050729, meaning July 29, 2005.
<--

-->How do I tell what version is installed?#
Once you have the software installed, you can see the date and the SR number by viewing the "about" information, which appears on the "splash screen" when you start Rhino, or can be viewed by doing Rhino > Help > About [[rhino:rhinoceros|Rhinoceros]].
\\
For Flamingo, do the FlamingoAbout command. For Bongo, do the BongoAbout command.
<--

-->How do I get a Service Release?#
The quick way is to use the Check for Updates service.  In Rhino, pull down the Help menu, and pick Check for Updates.  If you are connected to the internet, the McNeel web servers will offer the correct Service Release if there is one newer than your software.  For Flamingo, pull down the Raytrace or Photometric menu and pick Check for Updates.  For Bongo, pull down the Bongo menu and pick Check for Updates.
\\
In Rhino 5, go to **Tools, Options, Updates and Service Releases** and set the frequency to "Service Releases" or if you are brave, try "Release Cndidates." When you close Rhino, it will prompt you to approve the install of the latest and greatest. You may decline and run it after a future session.
<--

-->Can I delete older versions in "Add or Remove Programs" without causing problems?#
The "Add or Remove Programs" entry in the Control Panel in Windows is reporting all Service Releases as an installed program, each using approx. 250MB of disk space. This is somewhat misleading. Windows reports the total as though all installed files are added on to the existing installation even though many if not all files are actually overwritten on install. Do **not** use the "Add or Remove Programs" to remove older Service Releases of Rhino 5.

<--

-->Rhino 5 Install Never Completes#
See this page [[rhino:debuginstaller|DebugInstaller]] for instructions on how to generate a logfile of the error and get Technical Support involved.
<--

-->Error 1327 - Invalid Drive:#
**//Question://** //I get "Error 1327. Invalid Drive (E:, F:, etc)" when installing//

**//Cause://** //Your user account has settings indicating that one or more non-existent drives should be used for special folders such as "My Documents"//

**//Solution://**
  - From the Start menu, click Run.
  - Type RegEdit, then click Run
  - Browse to HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders
  - Look for directories listed that contain the drive letter mentioned in the error from the installer. Change them to point to a valid drive and folder.
  - Browse to HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders
  - Look for directories listed that contain the drive letter mentioned in the error from 

**Note:** This method, or task contains steps that tell you how to modify the registry. However, serious problems might occur if you modify the registry incorrectly. Therefore, make sure that you follow these steps carefully. For added protection, back up the registry before you modify it. Then, you can restore the registry if a problem occurs. For more information about how to back up and restore the registry, click the following article number to view the article in the Microsoft Knowledge Base:
[[http://support.microsoft.com/kb/322756|How to back up and restore the registry in Windows ]]
<--

-->Error 1603 - XP x64#
If you are installing on 64-bit Windows XP, and you receive an error 1603, please install the Windows Installer 4.5 Redistributable from http://www.microsoft.com/en-us/download/details.aspx?id=8483
<--

-->Error 1935#
**//Question://** //I get "Error 1935. An error occurred during the installation of assembly "Microsoft.VC80.CRT, ..."//

**//Cause://** //This is a bug in the Microsoft C++ 2005 Redistributable Package//

**//Solution 1://**
  * **Disable the antivirus program on the system.** A user reported disabling AVG made Rhino installation work.
**//Solution 2://**
  * **Try to install several times.** A user reported Rhino installation succeeded when the third time he tried to install Rhino. He didn't do anything to the system.
**//Solution 3://**
  - On Windows Vista or Windows 7, From the Start menu, type Features.
  - Click **Turn Windows Features On or Off**
  - In the Windows Features dialog box, select the check box labeled **Windows Communication Foundation HTTP Activation**:
  - {{:rhino:rhino_1935_windows_features.png|}}
  - Click OK

If you are unable to enable this feature, or if the Windows Features dialog box appears and is empty, then your installation of Windows is corrupt and needs to be repaired. Please contact Microsoft Support for more assistance.

**//More Details://**
People who get this error while installing Rhino are also unable to install the [[http://www.microsoft.com/downloads/en/details.aspx?FamilyID=32bc1bee-a3f9-4c13-9c99-220b62a191ee&displaylang=en|Microsoft C++ 2005 Redistributable Package directly]] from Microsoft. Therefore, this is a problem with Windows and the Microsoft Redistributable Package, not with Rhino's installer.

<--

-->Error 2502#
**//Question://** When Rhino 5 prompts there's a new update ready to install, choose to install the update and get "Error 2502".

**{{http://wiki.mcneel.com/_media/rhino/k01373.png?400}}**

**//Cause://** The update installer doesn't have enough permission privileges.

**//Solution://**
  - Right-click on Rhino 5 shortcut icon.
  - Select "Run as Administrator".
  - Rhino 5's start plane prompts there's a new update ready to install.
  - Choose to install the update.

<--

-->NET Framework 4 installer error (HRESULT: 0xc8000222)#
**Problem:**\\ .NET Framework 4 failed to install because of error code HRESULT: 0xc8000222.

**Cause:**\\ Some files corrupted in the **Software Distribution folder**.

**Solution:**
  - Download [[http://files.na.mcneel.com/misc/Fix_0xc8000222.zip|Fix_0xc8000222.zip]].
  - Extract the **Fix_0xc8000222.bat** in the zip file to a folder.
  - Right-click on the Fix_0xc8000222.bat and select **Run as Administrator**.\\ <color #999999>What this batch file does:\\ 1) Disables </color><color black>Windows Update Service</color><color #999999>.\\ 2) Deletes </color><color black>C:\Windows\SoftwareDistribution</color><color #999999>.\\ 3) Enables </color><color black>Windows Update Service</color><color #999999> again.</color>
[[http://wiki.mcneel.com/rhino/installproblems|Back to top.]]

<--

-->Rhino 5 installer keeps asking for .NET Framework 4#
**Problem:**\\ Rhino 5 installer keeps asking for installing .NET Framework 4 first, and Rhino 5 fails to install. The .NET Framework 4 appears to exist on the computer.

**Cause:**\\ .NET Framework 4 is somehow broken on the system.

**Solution:**
  - Download <color #999999>[[http://files.na.mcneel.com/misc/dotnetfx_cleanup_tool.zip|.NET Framework Cleanup tool]]</color>.
  - Run .NET Framework Cleanup tool.
  - Select **.NET Framework - All versions** for the product to cleanup.\\ {{http://wiki.mcneel.com/_media/rhino/rhino5/k01521.png?w=405}}
  - Click the **Cleanup Now** button.
  - Reboot your computer.
  - Install Rhino 5 from your Rhino 5 DVD.\\ <color #999999>The Rhino 5 DVD installer will install .NET Framework 4 first and then install Rhino 5.\\ If you are installing </color><color black>Rhino 5 evaluation version</color><color #999999>, you'll need to [[http://www.microsoft.com/en-us/download/details.aspx?id=17718|download]] and re-install .NET Framework 4 full version before installing Rhino 5. </color>

<--

-->.NET Framework 4 installer error (exit code -2145124330)#
**//Problem://** I get a .NET Framework 4.0 installer error while installing Rhino 5.

**//Solution://** Repair .NET Framework before installing Rhino 5.
  - Download [[http://www.microsoft.com/en-us/download/details.aspx?id=30135|Microsoft .NET Framework Repair Tool]].
  - Run the repair tool.
  - Keep clicking the "Next" button until you get only one "Finish" button to click.
  - Install Rhino 5 again.

<--

-->Missing DLL#
Problem: Installation fails with a missing dll message like: 

**//There is a problem with the Windows Installer package. A DLL required for this install to complete could not be run. Contact your support personnel or package vendor//**

Solution: It may be that a virus scanner is getting in the way- try disabling any virus scanners and retry the installation. Or your system may be missing important **Windows Updates**. 
  * //To see how to check for Windows updates [[http://wiki.mcneel.com/windows_updates|here.]]//

<--

-->Windows 7/8 is not a supported system?#
**Problem:**\\ I'm using Windows 7/8, but Rhino 5 DVD installer says my system is not supported.

**Solution:**\\ 
  - Right-click on the exe installer, select **Properties**.
  - Go to the **Compatibility** tab.\\ <color #999999>The compatibility mode may be set to "Windows XP (Service Pack 2)" and can't be changed.</color>
  - Click the **Change settings for all users** button near the bottom.
  - Clear the **Run this program in compatibility mode** checkbox. 
  - Click **OK** two times to close the dialogs.
  - Right-click on the exe installer again and select **Run as administrator** to install.

<--

-->Rhino V5 64-bit will not run but V5 32-bit will#
**Problem:**\\ When I try to start 64-bit Rhino V5, I get this error message.
{{http://wiki.mcneel.com/_media/rhino/5/0xc000007b.png?450}}\\

**//Solution://** 
  * [[http://wiki.mcneel.com/rhino/rhino5/error0xc000007b|Fixing Rhino 5: Error 0xc000007b]]\\

<--

-->Installer reports WinXP not supported when running Win7/8?#
Sometimes the installer on the SR0 V5 DVD will report that Rhino can not be installed on Windows XP when the user is actually running Windows 7 or 8.\\
The fix is to download an updated installer. Go to the Download page and download the Rhino V5 full version. Use that file to install rhino V5.

<--

-->Incomplete Rhino 5.0 Install Without the Language Pack#
Are you mssing templates, toolbars, or plugins? This is a symptom that the language pack was not installed. This can be a incomplete or "botched" install if you are installing from the CD or an error in the install script if you are installing from an MSI script.

If you install Rhino with the MSI install script above, but forget the language pack line, you will need to manually run the MSI for the langauge pack on your systems. It is also located on the Rhino 5 CD in the Installers folder.

To verify if the language support is installed look for the localization, plug-ins, UI folder here:
C:\Users\<login>\AppData\Roaming\McNeel\Rhinoceros\5.0. 

If these folders are missing or if you have already opened Rhino, you will have found no toolbars, templates, and Help. To fix this, do the following:
     - Run the MSI for the language pack
     - Open Rhino and type **ToolbarReset**. 
     - Close Rhino and reopen. This will delete the scheme in the registry, and reopening will reset it with the missing components.

<--

{{tag>rhino5installation}}